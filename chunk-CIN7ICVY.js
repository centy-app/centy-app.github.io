import{a as Q,b as g,c as X,d as E,e as Y}from"./chunk-CIVVD2A5.js";import{a as S,e as u}from"./chunk-R2BNHJJJ.js";import{d as K}from"./chunk-SW375WJ6.js";import{$b as F,Ab as P,Ec as H,Ka as T,Kc as J,La as v,Ma as h,Na as w,Ra as o,Sa as r,Ua as D,Ub as A,Va as b,Vb as R,Wa as m,Wb as L,Xa as p,Xb as N,Yb as j,Zb as W,_b as B,aa as f,ac as G,bb as a,bc as U,cc as k,db as M,ea as $,eb as x,fb as O,la as _,ma as C,ra as I,uc as q,vc as z,ya as c,za as y}from"./chunk-HMK3YC4P.js";function Z(s,l){if(s&1){let i=b();o(0,"mat-tree-node",6),a(1),o(2,"button",7),m("click",function(){let n=_(i).$implicit,t=p();return C(t.onCreateSubCategory(n))}),o(3,"mat-icon"),a(4,"add"),r()(),o(5,"button",7),m("click",function(){let n=_(i).$implicit,t=p();return C(t.openDeleteConfirmationDialog(n))}),o(6,"mat-icon"),a(7,"delete"),r()()()}if(s&2){let i=l.$implicit;c(),x(" ",i.name," ",i.currencyCode," ")}}function ee(s,l){if(s&1){let i=b();o(0,"mat-nested-tree-node")(1,"div",8)(2,"button",9)(3,"mat-icon",10),a(4),r()(),a(5),o(6,"button",7),m("click",function(){let n=_(i).$implicit,t=p();return C(t.onCreateSubCategory(n))}),o(7,"mat-icon"),a(8,"add"),r()(),o(9,"button",7),m("click",function(){let n=_(i).$implicit,t=p();return C(t.openDeleteConfirmationDialog(n))}),o(10,"mat-icon"),a(11,"delete"),r()()(),o(12,"div",11),D(13,12),r()()}if(s&2){let i=l.$implicit,e=p();c(2),v("aria-label","Toggle "+i.name),c(2),M(" ",e.spendingTreeControl.isExpanded(i)?"expand_more":"chevron_right"," "),c(),x(" ",i.name," ",i.currencyCode," "),c(7),w("example-tree-invisible",!e.spendingTreeControl.isExpanded(i))}}function te(s,l){if(s&1){let i=b();o(0,"mat-tree-node",6),a(1),o(2,"button",7),m("click",function(){let n=_(i).$implicit,t=p();return C(t.onCreateSubCategory(n))}),o(3,"mat-icon"),a(4,"add"),r()(),o(5,"button",7),m("click",function(){let n=_(i).$implicit,t=p();return C(t.openDeleteConfirmationDialog(n))}),o(6,"mat-icon"),a(7,"delete"),r()()()}if(s&2){let i=l.$implicit;c(),x(" ",i.name," ",i.currencyCode," ")}}function ne(s,l){if(s&1){let i=b();o(0,"mat-nested-tree-node")(1,"div",8)(2,"button",9)(3,"mat-icon",10),a(4),r()(),a(5),o(6,"button",7),m("click",function(){let n=_(i).$implicit,t=p();return C(t.onCreateSubCategory(n))}),o(7,"mat-icon"),a(8,"add"),r()(),o(9,"button",7),m("click",function(){let n=_(i).$implicit,t=p();return C(t.openDeleteConfirmationDialog(n))}),o(10,"mat-icon"),a(11,"delete"),r()()(),o(12,"div",11),D(13,12),r()()}if(s&2){let i=l.$implicit,e=p();c(2),v("aria-label","Toggle "+i.name),c(2),M(" ",e.assetsTreeControl.isExpanded(i)?"expand_more":"chevron_right"," "),c(),x(" ",i.name," ",i.currencyCode," "),c(7),w("example-tree-invisible",!e.assetsTreeControl.isExpanded(i))}}var ve=(()=>{let l=class l{constructor(e,n,t){this.store=e,this.categoriesService=n,this.dialog=t,this.spendingTreeControl=new N(d=>d.children),this.spendingDataSource=new k,this.assetsTreeControl=new N(d=>d.children),this.assetsDataSource=new k,this.spendingCategories$=f(u).select(E.getSpendingCategories),this.assetsCategories$=f(u).select(E.getAssetsCategories),this.defaultCurrency$=f(u).select(Q.getDefaultCurrency),this.destroyRef=f(I),this.hasChild=(d,V)=>!!V.children&&V.children.length>0,this.spendingCategories$.pipe(S(this.destroyRef)).subscribe(d=>{this.spendingDataSource.data=d,this.expandAllNodes(this.spendingTreeControl,d)}),this.assetsCategories$.pipe(S(this.destroyRef)).subscribe(d=>{this.assetsDataSource.data=d,this.expandAllNodes(this.assetsTreeControl,d)})}ngOnInit(){this.store.dispatch(new g)}onCreateTopLevelSpendingCategory(){this.defaultCurrency$.pipe(S(this.destroyRef)).subscribe(e=>{let n={parentId:void 0,type:0,name:"New Top Level Spending",currencyCode:e,iconId:void 0};this.categoriesService.createCategory(n).subscribe(()=>{this.store.dispatch(new g)})})}onCreateTopLevelAssetCategory(){this.defaultCurrency$.pipe(S(this.destroyRef)).subscribe(e=>{let n={parentId:void 0,type:1,name:"New Top Level Asset",currencyCode:e,iconId:void 0};this.categoriesService.createCategory(n).subscribe(()=>{this.store.dispatch(new g)})})}onCreateSubCategory(e){let n={parentId:e.id,type:e.type,name:"New Subcategory",currencyCode:e.currencyCode,iconId:void 0};this.categoriesService.createCategory(n).subscribe(()=>{this.store.dispatch(new g)})}onDeleteCategory(e){this.categoriesService.deleteCategory(e.id).subscribe(()=>{this.store.dispatch(new g)})}openDeleteConfirmationDialog(e){this.dialog.open(Y,{width:"250px",data:{name:e.name}}).afterClosed().subscribe(t=>{t&&this.onDeleteCategory(e)})}expandAllNodes(e,n){n.forEach(t=>{e.expand(t),t.children&&this.expandAllNodes(e,t.children)})}};l.\u0275fac=function(n){return new(n||l)(y(u),y(X),y(H))},l.\u0275cmp=$({type:l,selectors:[["app-categories"]],standalone:!0,features:[O],decls:13,vars:6,consts:[["label","Spending"],["mat-raised-button","","color","primary",3,"click"],[1,"example-tree",3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],["label","Assets"],["matTreeNodeToggle",""],["mat-icon-button","",3,"click"],[1,"mat-tree-node"],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["role","group"],["matTreeNodeOutlet",""]],template:function(n,t){n&1&&(o(0,"mat-tab-group")(1,"mat-tab",0)(2,"button",1),m("click",function(){return t.onCreateTopLevelSpendingCategory()}),a(3,"New Spending Category"),r(),o(4,"mat-tree",2),T(5,Z,8,2,"mat-tree-node",3)(6,ee,14,6,"mat-nested-tree-node",4),r()(),o(7,"mat-tab",5)(8,"button",1),m("click",function(){return t.onCreateTopLevelAssetCategory()}),a(9,"New Asset Category"),r(),o(10,"mat-tree",2),T(11,te,8,2,"mat-tree-node",3)(12,ne,14,6,"mat-nested-tree-node",4),r()()()),n&2&&(c(4),h("dataSource",t.spendingDataSource)("treeControl",t.spendingTreeControl),c(2),h("matTreeNodeDefWhen",t.hasChild),c(4),h("dataSource",t.assetsDataSource)("treeControl",t.assetsTreeControl),c(2),h("matTreeNodeDefWhen",t.hasChild))},dependencies:[P,J,A,R,L,B,W,U,G,j,F,q,z,K],styles:[".mat-tree[_ngcontent-%COMP%]{background-color:var(--mat-sidenav-content-background-color)}.example-tree-invisible[_ngcontent-%COMP%]{display:none}.example-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .example-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;list-style-type:none}.example-tree[_ngcontent-%COMP%]   .mat-nested-tree-node[_ngcontent-%COMP%]   div[role=group][_ngcontent-%COMP%]{padding-left:40px}.example-tree[_ngcontent-%COMP%]   div[role=group][_ngcontent-%COMP%] > .mat-tree-node[_ngcontent-%COMP%]{padding-left:40px}[_nghost-%COMP%]     .mat-mdc-tab-body-content{overflow:hidden!important}"]});let s=l;return s})();export{ve as CategoriesComponent};
