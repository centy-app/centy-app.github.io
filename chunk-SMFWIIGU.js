import{a as fe}from"./chunk-GELGKNNB.js";import{a as ge}from"./chunk-4AIDGMA6.js";import"./chunk-O6VVPN34.js";import{a as pe,m as _,n as R,o as de,u as ue}from"./chunk-S23KONLI.js";import{$a as j,Ac as se,Ba as a,E as b,Ea as p,Eb as q,Fc as me,Gc as ce,Ka as F,Mb as A,Nb as G,Pc as le,Sb as $,Xa as d,Xb as z,Ya as L,Za as u,_a as I,a as v,ab as l,ba as D,bb as s,cb as o,db as f,fa as w,ga as y,hc as N,ib as B,ic as g,jb as T,jc as U,kb as x,kc as K,la as E,lc as J,ma as O,mc as C,nc as Q,oc as W,pa as k,pc as X,q as h,qb as c,qc as Y,rb as V,rc as Z,sc as ee,tc as te,ub as H,uc as ie,vb as S,vc as re,wb as P,wc as ne,xc as oe,y as M,yc as ae}from"./chunk-E7ADILNX.js";var he=de("currenciesState"),Ce=R(he,e=>e.currencies),_e=R(he,e=>e.isLoading);var ve=(()=>{let t=class t{constructor(r,i){this.http=r,this.loginService=i,this.registerUrl=ue.baseApiUrl+"auth/register"}registerAndLoginRemote(r){var i={email:"",token:"",baseCurrencyCode:""};return this.registerRemote(r).pipe(M(m=>m.success?this.loginService.loginRemote({email:r.email,password:r.password}):h(v(v({},m),i))),b(m=>h(v({errors:m?.error?.errors,success:!1},i))))}registerRemote(r){let i={"content-type":"application/json"};return this.http.post(this.registerUrl,r,{headers:i}).pipe(M(()=>h({errors:[],success:!0})),b(m=>h({errors:m?.error?.errors,success:!1})))}};t.\u0275fac=function(i){return new(i||t)(w($),w(ge))},t.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var xe=(e,t)=>t.code;function Se(e,t){e&1&&f(0,"mat-spinner")}function Pe(e,t){e&1&&f(0,"img",3)}function Re(e,t){e&1&&(s(0,"mat-error"),c(1,"Email is invalid"),o())}function De(e,t){e&1&&(s(0,"mat-error"),c(1,"Password is required"),o())}function Ee(e,t){e&1&&(s(0,"mat-error"),c(1,"Password should match"),o())}function Oe(e,t){if(e&1&&(s(0,"mat-option",7),c(1),o()),e&2){let n=t.$implicit;l("value",H(n.code)),a(),V(n.description)}}function ke(e,t){if(e&1){let n=B();s(0,"form",2),T("ngSubmit",function(){E(n);let i=x();return O(i.onRegister())}),d(1,Pe,1,0,"img",3),s(2,"mat-form-field")(3,"mat-label"),c(4,"Email"),o(),f(5,"input",4),d(6,Re,2,0,"mat-error"),o(),s(7,"mat-form-field")(8,"mat-label"),c(9,"Password"),o(),f(10,"input",5),d(11,De,2,0,"mat-error"),o(),s(12,"mat-form-field")(13,"mat-label"),c(14,"Confirm password"),o(),f(15,"input",5),d(16,Ee,2,0,"mat-error"),o(),s(17,"mat-form-field")(18,"mat-label"),c(19,"Base currency"),o(),s(20,"mat-select",6),I(21,Oe,2,3,"mat-option",7,xe),S(23,"async"),o()(),s(24,"button",8),c(25,"Register"),o()()}if(e&2){let n=x();l("formGroup",n.registerForm),a(),u(n.isDesktopHeight.matches?1:-1),a(4),l("formControl",n.email),a(),u(n.email.invalid?6:-1),a(4),l("formControl",n.password),a(),u(n.password.invalid?11:-1),a(4),l("formControl",n.confirm),a(),u(n.confirm.invalid?16:-1),a(4),l("formControl",n.currency),a(),j(P(23,10,n.currencies$)),a(3),l("disabled",!n.registerForm.valid||n.submitButtonDisabled)}}var nt=(()=>{let t=class t{constructor(r,i,m,ye,Me){this.registerService=r,this.changeDetectorRef=i,this.media=m,this.snackBar=ye,this.store=Me,this.submitButtonDisabled=!1,this.currencies$=y(_).select(Ce),this.isLoading$=y(_).select(_e),this.destroyRef=y(k)}ngOnInit(){this.initialyzeMediaMatcherListener(),this.initialyzeFormComponents(),this.store.dispatch(fe())}onRegister(){this.submitButtonDisabled=!0,this.registerService.registerAndLoginRemote({email:this.email.value,password:this.password.value,baseCurrencyCode:this.currency.value}).pipe(pe(this.destroyRef)).subscribe(r=>{r.success||r.errors.forEach(i=>{this.snackBar.open(i,"OK")}),this.submitButtonDisabled=!1})}initialyzeMediaMatcherListener(){this.isDesktopHeight=this.media.matchMedia("(min-height: 700px)"),this.isDesktopHeightListener=()=>this.changeDetectorRef.detectChanges(),this.isDesktopHeight.addEventListener("change",this.isDesktopHeightListener)}initialyzeFormComponents(){this.email=new C("",[g.required,g.email]),this.password=new C("",g.required),this.confirm=new C("",g.required),this.currency=new C("",g.required),this.confirm.addValidators(this.createCompareValidator(this.password,this.confirm)),this.registerForm=new J({email:this.email,password:this.password,confirm:this.confirm,currency:this.currency})}createCompareValidator(r,i){return()=>r.value!==i.value?{match_error:"Password should match"}:null}ngOnDestroy(){this.isDesktopHeight.removeEventListener("change",this.isDesktopHeightListener)}};t.\u0275fac=function(i){return new(i||t)(p(ve),p(q),p(z),p(me),p(_))},t.\u0275cmp=F({type:t,selectors:[["app-register"]],decls:4,vars:3,consts:[["id","register-page"],["id","register-form",3,"formGroup"],["id","register-form",3,"ngSubmit","formGroup"],["src","../../../assets/typing.gif","alt","cat"],["matInput","","required","","autocomplete","new-email","placeholder","name@domain.com","required","",3,"formControl"],["matInput","","type","password","autocomplete","new-password",3,"formControl"],["required","",3,"formControl"],[3,"value"],["mat-raised-button","","color","primary",3,"disabled"]],template:function(i,m){i&1&&(s(0,"div",0),d(1,Se,1,0,"mat-spinner"),S(2,"async"),L(3,ke,26,12,"form",1),o()),i&2&&(a(),u(P(2,1,m.isLoading$)?1:3))},dependencies:[G,le,ne,re,te,ie,se,ae,oe,ce,Z,Q,N,U,K,Y,ee,W,X,A],styles:["#register-page[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}#register-page[_ngcontent-%COMP%]   #register-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}#register-page[_ngcontent-%COMP%]   #register-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, #register-page[_ngcontent-%COMP%]   #register-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus{transition:background-color 600000s 0s,color 600000s 0s}#register-page[_ngcontent-%COMP%]   #register-form[_ngcontent-%COMP%]   input[data-autocompleted][_ngcontent-%COMP%]{background-color:transparent!important}#register-page[_ngcontent-%COMP%]   #register-form[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:210px;margin-bottom:12pt;border-radius:5%}#register-page[_ngcontent-%COMP%]   #register-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:160pt;height:40pt;font-size:11pt}"]});let e=t;return e})();export{nt as RegisterComponent};
